# Руководство администратора системы наценок

## Начало работы

### Доступ к системе
1. Войдите в админ-панель платформы
2. Перейдите в раздел "Наценки" в меню управления
3. Убедитесь, что у вас есть права доступа к управлению наценками

### Обзор интерфейса

Интерфейс системы состоит из нескольких разделов:

- **Список наценок** - просмотр и управление всеми наценками
- **Создание/редактирование** - форма настройки наценки
- **Тестирование** - интерактивный калькулятор
- **Статистика** - аналитика применения
- **Журнал аудита** - история изменений
- **Массовые операции** - групповое управление

## Создание наценки

### Основные настройки

#### Платформа
- Выберите платформу, для которой применяется наценка
- Обычно используется "Основная платформа"

#### Контекст применения
- **Заказы** - для финальных заказов аренды
- **Заявки на аренду** - для расчетов в заявках
- **Предложения** - для коммерческих предложений

#### Тип наценки
- **Фиксированная** - постоянная сумма за час
- **Процентная** - процент от базовой цены
- **Ступенчатая** - зависит от объема/срока
- **Комбинированная** - фиксированная + процентная
- **Сезонная** - коэффициенты по сезонам

### Область применения

#### Общая наценка
- Применяется ко всем операциям выбранного контекста
- Используется как наценка по умолчанию

#### Привязка к сущностям
- **Оборудование** - для конкретной техники
- **Категория** - для категории оборудования
- **Компания** - для компании арендатора

### Приоритет системы

Приоритет определяет порядок применения наценок:

- **0-99** - Общие наценки (низший приоритет)
- **100-199** - Наценки компаний
- **200-299** - Наценки категорий  
- **300-399** - Наценки оборудования (высший приоритет)

### Период действия

- **Действует с** - дата начала действия
- **Действует до** - дата окончания действия
- Оставьте пустыми для постоянного действия

## Типы наценок и их настройка

### Фиксированная наценка

**Настройка:**
- Значение: сумма в рублях за час работы
- Пример: `100` = 100 рублей за каждый час аренды

**Расчет:**
Наценка = Значение × Рабочие_часы

text

### Процентная наценка

**Настройка:**
- Значение: процент от базовой цены
- Пример: `10` = 10% от стоимости аренды

**Расчет:**
Наценка = Базовая_цена × (Значение / 100)

text

### Ступенчатая наценка

**Настройка:**
1. Укажите базовое значение (используется если не подходят ступени)
2. Добавьте ступени с условиями:
   - Мин. часы / Макс. часы
   - Тип значения (фиксированная/процентная)
   - Значение наценки

**Пример ступеней:**
0-100 часов: 50 ₽/час (фиксированная)
101-200 часов: 40 ₽/час (фиксированная)
201+ часов: 5% (процентная)

text

### Комбинированная наценка

**Настройка:**
- Фиксированная часть (₽/час)
- Процентная часть (%)
- Пример: `50 ₽ + 5%`

**Расчет:**
Наценка = (Фиксированная × Часы) + (Базовая_цена × Процентная / 100)

text

### Сезонная наценка

**Настройка:**
- Базовый процент наценки
- Коэффициенты для сезонов:
  - Высокий сезон (май-сентябрь)
  - Средний сезон (март-апрель, октябрь)
  - Низкий сезон (ноябрь-февраль)

**Расчет:**
Наценка = Базовая_цена × (Базовый_процент / 100) × Коэффициент_сезона

text

## Тестирование наценок

### Интерактивный тестер

Используйте встроенный тестер для проверки расчетов:

1. **Базовая цена** - стоимость аренды за час
2. **Рабочие часы** - продолжительность аренды
3. **Контекст** - тип операции (заказ/заявка/предложение)
4. **ID сущностей** - для тестирования привязанных наценок

### Пакетное тестирование

Запустите несколько тестов одновременно для сравнения:
- Разные базовые цены
- Разное количество часов
- Разные контексты применения

### История тестов

- Сохраняйте результаты для анализа
- Сравнивайте разные сценарии
- Экспортируйте данные для отчетов

## Массовые операции

### Быстрый выбор

Используйте предустановленные фильтры для выбора групп наценок:
- Все наценки
- Только активные
- Только неактивные
- Истекшие наценки
- Общие наценки

### Операции со статусом

- **Активировать** - сделать наценки активными
- **Деактивировать** - отключить наценки
- **Переключить** - инвертировать статус

### Изменение приоритета

Установите единый приоритет для выбранных наценок:
- Общие: 0-99
- Компании: 100-199  
- Категории: 200-299
- Оборудование: 300-399

### Обновление значений

**Типы обновлений:**
- Фиксированное значение
- Увеличить на процент
- Уменьшить на процент
- Умножить на коэффициент

**Фильтрация по типам:**
- Применяйте изменения только к определенным типам наценок

### Обновление периодов

**Опции:**
- Установить конкретные даты
- Продлить действие на указанное количество дней
- Очистить даты (сделать постоянными)

### Опасные операции

**Дублирование** - создание копий выбранных наценок
**Удаление** - безвозвратное удаление наценок
**Архивирование** - деактивация с сохранением истории

⚠️ **Внимание!** Опасные операции требуют подтверждения и не могут быть отменены.

## Мониторинг и аналитика

### Ключевые метрики

На главной странице статистики отображаются:
- **Всего применений** - количество использований наценок
- **Общий доход** - суммарный доход от наценок
- **Активных наценок** - количество активных правил
- **Средняя наценка** - среднее значение на применение

### Графики и отчеты

#### Динамика применения
- Тренды использования наценок по времени
- Сравнение доходов от разных типов наценок

#### Распределение по типам
- Круговые диаграммы использования типов наценок
- Эффективность разных подходов к ценообразованию

#### Топ наценок
- Список наиболее доходных наценок
- Показатели эффективности применения

### Детальный анализ

#### Производительность
- Время расчета наценок
- Распределение времени ответа
- Оптимизация быстродействия

#### Сезонность
- Анализ сезонных колебаний
- Эффективность сезонных наценок
- Рекомендации по коэффициентам

#### Сравнение периодов
- Изменения ключевых показателей
- Анализ эффективности изменений
- Выявление трендов

## Журнал аудита

### Просмотр истории

Фильтруйте записи по:
- **Действию** - создание, обновление, удаление
- **Пользователю** - кто совершил изменение
- **Наценке** - конкретная наценка
- **Периоду** - дата изменения

### Детали изменений

Для каждой записи доступно:
- Полная информация об изменении
- Сравнение старых и новых значений
- Причина изменения (если указана)
- Временная метка и пользователь

### Экспорт данных

Выгружайте данные аудита в форматах:
- **CSV** - для анализа в табличных редакторах
- **JSON** - для интеграции с другими системами

## Советы и лучшие практики

### Планирование наценок

1. **Начните с общих наценок** - установите базовые правила
2. **Добавляйте исключения** - для особых случаев используйте приоритеты
3. **Тестируйте изменения** - используйте тестер перед применением
4. **Мониторьте эффективность** - анализируйте статистику регулярно

### Управление приоритетами

- Используйте понятную систему нумерации
- Оставляйте зазоры между группами для будущих изменений
- Документируйте правила приоритетов

### Безопасность изменений

- Всегда указывайте причину изменений в массовых операциях
- Используйте режим предпросмотра перед применением
- Регулярно делайте резервные копии конфигураций

### Оптимизация производительности

- Избегайте избыточного количества активных наценок
- Используйте кэширование для часто применяемых правил
- Мониторьте время выполнения расчетов

## Устранение неисправностей

### Частые проблемы

**Наценка не применяется:**
- Проверьте статус активности
- Убедитесь, что период действия не истек
- Проверьте приоритет относительно других наценок

**Некорректный расчет:**
- Проверьте тип и значение наценки
- Убедитесь в правильности рабочих часов
- Протестируйте в калькуляторе

**Медленная работа:**
- Уменьшите количество активных наценок
- Проверьте индексацию в базе данных
- Используйте кэширование

### Получение помощи

При возникновении проблем:
1. Проверьте журнал аудита для анализа изменений
2. Используйте тестер для воспроизведения проблемы
3. Обратитесь к технической документации
4. Свяжитесь с технической поддержкой

## Обновления системы

Система наценок регулярно обновляется. Следите за:
- Новыми типами наценок
- Улучшениями интерфейса
- Оптимизациями производительности
- Расширением аналитических возможностей

Перед обновлением:
- Сделайте резервную копию конфигураций
- Протестируйте критический функционал
- Ознакомьтесь с изменениями в документации
